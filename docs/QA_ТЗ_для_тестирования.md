# Техническое задание для тестирования — Padix

**Версия:** 1.0  
**Дата:** 2025-02-02  
**Назначение:** Полное ТЗ для передачи тестировщику

---

## 1. Общее описание

**Padix** — веб-приложение для организации игр в падел. Пользователи могут:
- создавать игры и записываться на них;
- вести учёт очков и рейтинга;
- добавлять друзей и приглашать их на игры;
- просматривать рейтинг и историю матчей.

**Стек:** React + TypeScript (фронтенд), Kotlin + Spring Boot (бэкенд), PostgreSQL.

---

## 2. Роли пользователей

| Роль | Описание |
|------|----------|
| **Гость** | Не авторизован. Видит рейтинг, список игр. Не может записываться, создавать игры, вводить счёт. |
| **Участник** | Авторизован, прошёл опрос. Может записываться на игры, добавлять друзей, видеть профиль. |
| **Автор игры** | Создал игру. Может закрывать регистрацию, начинать игру, вводить счёт, завершать игру, удалять участников (до закрытия регистрации). |
| **Администратор** | Отдельный вход на `/admin`. Управление пользователями (отключение, редактирование, создание). |

---

## 3. Маршруты (страницы)

| Путь | Название | Доступ |
|------|----------|--------|
| `/` | Главная | Все |
| `/rating` | Рейтинг | Все |
| `/login` | Вход | Гости |
| `/register` | Регистрация | Гости |
| `/survey` | Опрос (тест рейтинга) | Обязательно после регистрации |
| `/games` | Список игр | Все |
| `/create` | Создать игру | Только авторизованные |
| `/profile` | Профиль | Только авторизованные |
| `/events/:id` | Страница игры | Все (разный функционал) |
| `/admin` | Админка | Администратор |

---

## 4. Сценарии для тестирования

### 4.1. Регистрация и вход

**Регистрация (`/register`)**
- [ ] Регистрация с валидными email, паролем, именем — успех, редирект на опрос.
- [ ] Дубликат email — ошибка.
- [ ] Пустые поля — ошибка валидации.
- [ ] Некорректный email — ошибка.

**Вход (`/login`)**
- [ ] Правильные email и пароль — успех, редирект на главную или опрос (если не пройден).
- [ ] Неверный пароль — ошибка.
- [ ] Несуществующий email — ошибка.

**Обязательный опрос**
- [ ] После регистрации пользователь перенаправляется на `/survey`.
- [ ] Без прохождения опроса нельзя зайти на остальные страницы (кроме `/survey`).
- [ ] Все вопросы опроса должны быть заполнены для отправки.
- [ ] После отправки показывается предварительный рейтинг и количество калибровочных игр.

---

### 4.2. Главная страница (`/`)

- [ ] Отображаются ближайшие игры (до 2 недель).
- [ ] Отображается топ-3 игроков с аватарами и рейтингами.
- [ ] Статистика: активные игроки, игры сегодня, матчи за неделю.
- [ ] Кнопки «Найти игру», «Создать игру» (или «Регистрация» для гостей).
- [ ] Аватары игроков отображаются (если загружены).

---

### 4.3. Рейтинг (`/rating`)

- [ ] Таблица игроков: рейтинг, NTRP, кол-во матчей.
- [ ] Аватары игроков отображаются.
- [ ] Топ-3 игроков в карточках.
- [ ] При авторизации: клик по игроку открывает тултип (рейтинг, NTRP, матчи, кнопка «Добавить в друзья»).
- [ ] Гости видят только рейтинг. После регистрации — доступ к рейтингу.

---

### 4.4. Список игр (`/games`)

- [ ] Список предстоящих игр (до 14 дней), с датой, временем, формой «Американка».
- [ ] Кнопка «Календарь» открывает календарь.
- [ ] Календарь: переключение месяцев, выбор дня, список игр на выбранный день.
- [ ] Кнопка «Подробнее» ведёт на страницу игры.
- [ ] Бейджи статусов: «Регистрация», «В процессе», «Завершено».

---

### 4.5. Создание игры (`/create`)

**Поля:**
- Название (по умолчанию «Американка»)
- Дата и время начала/окончания
- Количество кортов (1–8)
- Названия кортов (автозаполнение при смене кол-ва)
- Режим: «Равный бой» (BALANCED) или «Круговая» (ROUND_ROBIN)
- Очки на игрока за матч (по умолчанию 6)

**Валидация:**
- [ ] Дата и время должны быть в будущем.
- [ ] Время окончания должно быть позже начала.
- [ ] Без авторизации — редирект на логин.

**Результат:**
- [ ] Создание игры — редирект на страницу игры.

---

### 4.6. Страница игры (`/events/:id`)

#### 4.6.1. Статусы игры

| Статус | Описание |
|--------|----------|
| DRAFT | Черновик (не используется в текущем UI) |
| OPEN_FOR_REGISTRATION | Регистрация открыта |
| REGISTRATION_CLOSED | Регистрация закрыта |
| IN_PROGRESS | Игра идёт |
| FINISHED | Игра завершена |
| CANCELLED | Отменена |

#### 4.6.2. Регистрация (OPEN_FOR_REGISTRATION)

- [ ] Отображаются зарегистрированные игроки (с аватарами, рейтингом).
- [ ] Кнопка «Записаться» — для авторизованных.
- [ ] Кнопка «Вы записаны (отменить)» — для записанных.
- [ ] **Только автор:** кнопка «Закрыть регистрацию», «Пригласить» (слоты для друзей).
- [ ] **Только автор:** крестики удаления у участников; при удалении — подтверждение.
- [ ] После закрытия регистрации крестики удаления исчезают.

#### 4.6.3. REGISTRATION_CLOSED

- [ ] **Только автор:** кнопка «Начать игру».
- [ ] Участники не могут начать игру.

#### 4.6.4. Игра идёт (IN_PROGRESS)

**Раунды и матчи:**
- [ ] Раунды отображаются в виде раскрывающихся блоков.
- [ ] В каждом раунде — матчи (по количеству кортов).
- [ ] У матча: команды A и B, игроки с аватарами, счёт.

**Ввод счёта (только автор, режим POINTS):**
- [ ] Клик по матчу — он становится активным, появляется панель ввода.
- [ ] Выбор очков для команды A или B.
- [ ] При вводе очков одной команды — автозаполнение второй (если сумма должна быть полной).
- [ ] **Автосохранение:** любой ввод сохраняется как черновик через ~700 мс.
- [ ] При переключении на другой корт — сохраняется предыдущий матч.
- [ ] Кнопка «Следующий корт» — если в раунде есть ещё незасчитанные матчи.
- [ ] Кнопка «Следующий раунд» — если все матчи раунда засчитаны.
- [ ] При неполной сумме очков — сохраняется черновик, переход к следующему корту.
- [ ] При полной сумме — финальный счёт, переход к следующему корту/раунду.

**Добавление раундов:**
- [ ] Кнопка «+ Раунд» — добавляет новый раунд с уникальными парами (не повторяет предыдущие).

**Завершение игры:**
- [ ] **Только автор:** кнопка «Завершить игру».
- [ ] При завершении черновики очков автоматически становятся финальными.

#### 4.6.5. Игра завершена (FINISHED)

- [ ] Кнопка «Статистика игры» (только для режима POINTS).
- [ ] Открывается модальное окно со списком игроков и их очками.

#### 4.6.6. Приглашения в игру

- [ ] **Только автор:** кнопка «Пригласить» — открывает список друзей.
- [ ] Можно пригласить только друзей.
- [ ] Участник видит приглашение в уведомлениях и профиле.

---

### 4.7. Профиль (`/profile`)

**Данные профиля:**
- [ ] Имя, email, публичный ID (копирование по клику).
- [ ] Рейтинг, NTRP, кол-во матчей.
- [ ] Аватар: загрузка с устройства, выбор из URL (например, dicebear.com).
- [ ] Аватар сохраняется в БД и отображается везде.

**Секция «Друзья»:**
- [ ] Добавление по ID (формат `#123456789`).
- [ ] Список друзей и входящих заявок.
- [ ] Аватары друзей отображаются.
- [ ] Клик по другу — тултип (рейтинг, NTRP, матчи).
- [ ] ID не отображается в списке друзей.
- [ ] В заявках: «Принять» / «Отклонить».

**Секция «История матчей»:**
- [ ] Список игр с датами, рейтинговыми изменениями.
- [ ] Клик по игре — детали матчей (счёт, результат, команды).

**История инвайтов:**
- [ ] Список приглашений в игры.
- [ ] «Принять» / «Отклонить».

---

### 4.8. Уведомления (иконка колокольчика в шапке)

- [ ] Отображается количество непрочитанных.
- [ ] Разделы: «Приглашения в игры», «Заявки в друзья».
- [ ] В заявках: аватар, имя (без ID).
- [ ] «Принять» / «Отклонить» для заявок в друзья.
- [ ] «Принять» / «Отклонить» для приглашений в игры.
- [ ] «Открыть игру» для приглашений.

---

### 4.9. Адаптивность

- [ ] Корректное отображение на десктопе (≥1024px).
- [ ] Корректное отображение на планшете (768–1023px).
- [ ] Корректное отображение на мобильном (<768px).
- [ ] На мобильной версии страницы игры: имена игроков над/под счётом.
- [ ] Мобильное меню открывается/закрывается.

---

### 4.10. Ошибки и граничные случаи

- [ ] Несуществующий ID игры — сообщение «Событие не найдено» или 404.
- [ ] Истёкший токен — редирект на логин.
- [ ] Ошибка сети — понятное сообщение.
- [ ] Дубликат записи на игру — сообщение об ошибке.
- [ ] Попытка сохранить счёт без прохождения опроса — «Нужно пройти опрос».
- [ ] Сохранение счёта не автором — «Сохранять счёт может только автор игры».
- [ ] Валидация очков: сумма не должна превышать `pointsPerPlayer * 4`.

---

### 4.11. Админка (`/admin`)

- [ ] Отдельная форма входа (логин/пароль).
- [ ] Список пользователей с поиском.
- [ ] Редактирование: имя, email, пароль, отключение.
- [ ] Создание пользователя.
- [ ] Восстановление аккаунта (для отключённых).

---

## 5. Данные для тестирования

**Тестовый пользователь:** создать через регистрацию или админку.

**Публичный ID:** формат `#100000001` (цифры). Используется для добавления в друзья и приглашений.

**Режимы подсчёта:** только POINTS (очки). Черновики очков поддерживаются только в режиме POINTS.

---

## 6. Чек-лист критичных сценариев

1. [ ] Регистрация → Опрос → Вход → Профиль.
2. [ ] Создание игры → Запись участников → Закрытие регистрации → Начало игры.
3. [ ] Ввод очков при 2 кортах: сохранение обоих матчей, автосохранение в черновик.
4. [ ] Завершение игры → Проверка статистики и рейтинга.
5. [ ] Добавление в друзья по ID → Принятие заявки → Приглашение на игру.
6. [ ] Аватары отображаются везде (профиль, рейтинг, список игр, друзья, уведомления).
7. [ ] Смена пользователя: аватар не «переезжает» между аккаунтами (нет утечки localStorage).

---

## 7. Известные ограничения

- Поддерживается только формат «Американка».
- Режим подсчёта — только POINTS.
- Сохранение счёта — только автор игры.
- Черновики очков — только для режима POINTS.
- Админка доступна по отдельному URL и токену.

---

## 8. Контакты и среда

- **URL:** уточнить у разработчика (localhost / staging / production).
- **Backend:** Spring Boot, порт по умолчанию 8080.
- **Frontend:** Vite, порт по умолчанию 5173.
